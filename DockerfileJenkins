FROM jenkins/jenkins:lts

RUN jenkins-plugin-cli --plugins workflow-aggregator
RUN jenkins-plugin-cli --plugins git
RUN jenkins-plugin-cli --plugins repo

COPY custom_config.xml /var/jenkins_home/config.xml

# TODO() Do we really need it?
COPY jenkins.yaml /var/jenkins_home/jenkins.yaml

USER root

RUN apt update && apt install -y snap awscli

# Doesn't work, snap not found even was intalled above
#RUN snap install aws-cli --channel=v2/stable --classic

USER jenkins

EXPOSE 8080
EXPOSE 50000